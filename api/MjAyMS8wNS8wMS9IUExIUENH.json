{"title":"HPLHPCG","date":"2021-04-30T16:00:00.000Z","date_formatted":{"ll":"2021年5月1日","L":"2021/05/01","MM-DD":"05-01"},"link":"2021/05/01/HPLHPCG","tags":["Note"],"categories":["USTB"],"updated":"2021-06-01T10:30:47.330Z","content":"<p><code>2021/5/12</code></p>\n<h5 id=\"0.安装前环境搭建\">0.安装前环境搭建<a title=\"#0.安装前环境搭建\" href=\"#0.安装前环境搭建\"></a></h5>\n<h6 id=\"0.1检查编译器\">0.1检查编译器<a title=\"#0.1检查编译器\" href=\"#0.1检查编译器\"></a></h6>\n<p><img src=\"C:%5CUsers%5C96191%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20210512225452022.png\" alt=\"image-20210512225452022\" class=\"φcx\"></p>\n<p><img src=\"C:%5CUsers%5C96191%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20210512225840757.png\" alt=\"image-20210512225840757\" class=\"φcx\"></p>\n<blockquote>\n<p>sudo apt update</p>\n</blockquote>\n<p>安装g++和m4</p>\n<blockquote>\n<p>sudo apt-get install g++</p>\n<p>sudo apt-get install m4</p>\n</blockquote>\n<h6 id=\"0.2安装gfortran\">0.2安装gfortran<a title=\"#0.2安装gfortran\" href=\"#0.2安装gfortran\"></a></h6>\n<blockquote>\n<p>sudo apt-get install gfortran</p>\n</blockquote>\n<h6 id=\"0.3安装blas库\">0.3安装BLAS库<a title=\"#0.3安装blas库\" href=\"#0.3安装blas库\"></a></h6>\n<blockquote>\n<p>BLAS的全称是Basic Linear Algebra Subprograms，中文可以叫做基础线性代数子程序。它定义了一组应用程序接口（API）标准，是一系列初级操作的规范，如向量之间的乘法、矩阵之间的乘法等。许多数值计算软件库都实现了这一核心。</p>\n</blockquote>\n<p>OpenBLAS下载并安装</p>\n<blockquote>\n<p>cd openblas-develop/</p>\n<p>make FC=gfortran</p>\n<p><img src=\"C:%5CUsers%5C96191%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20210512235136100.png\" alt=\"image-20210512235136100\" class=\"φcx\"></p>\n<p>make PREFIX=/usr/local/OpenBLAS-0.3.15 install</p>\n<p><img src=\"C:%5CUsers%5C96191%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20210512235415816.png\" alt=\"image-20210512235415816\" class=\"φcx\"></p>\n</blockquote>\n<h6 id=\"0.4安装mpi\">0.4安装MPI<a title=\"#0.4安装mpi\" href=\"#0.4安装mpi\"></a></h6>\n<blockquote>\n<p>MPI全称是message passing interface，即信息传递接口，是用于跨节点通讯的基础软件环境。它提供让相关进程之间进行通信，同步等操作的API，可以说是并行计算居家出游必备的基础库。</p>\n<p>而我们需要安装的是一种实现，常用的如MPICH2,MPICH3,openMPI，以及intle的MPI库</p>\n</blockquote>\n<p>MPICH安装</p>\n<blockquote>\n<p>下载中</p>\n<p><em>5.12end/</em></p>\n<p><code>5.13</code></p>\n<p>下载好MPICH</p>\n<p>安装</p>\n<blockquote>\n<p>./configure --prefix=/usr/local/openmpi-1.10.2</p>\n<p>make -j8</p>\n<p>make install</p>\n<p><img src=\"C:%5CUsers%5C96191%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20210513121444112.png\" alt=\"image-20210513121444112\" class=\"φcx\"></p>\n</blockquote>\n</blockquote>\n<h6 id=\"\"><a title=\"#\" href=\"#\"></a></h6>\n<h5 id=\"1.安装hpcg\">1.安装HPCG<a title=\"#1.安装hpcg\" href=\"#1.安装hpcg\"></a></h5>\n<h6 id=\"1.1下载\">1.1下载<a title=\"#1.1下载\" href=\"#1.1下载\"></a></h6>\n<blockquote>\n<p><code>git clone https://github.com/hpcg-benchmark/hpcg.git</code></p>\n<p>运行此步发现git未安装</p>\n<p>运行sudo apt install git</p>\n<p><img src=\"C:%5CUsers%5C96191%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20210513122108558.png\" alt=\"image-20210513122108558\" class=\"φcx\"></p>\n<p>出现进程占用提醒</p>\n<p>原因分析：在安裝軟件時，系統會標記一個值，也就是上锁，软件安装完成后才会解锁，如果出现报错无法获得锁，可以通过手动删除锁解决</p>\n<p>执行命令：</p>\n<blockquote>\n<p>sudo rm /var/cache/apt/archives/lock<br>\nsudo rm /var/lib/dpkg/lock</p>\n</blockquote>\n<p>解决，继续安装git然后下载HPCG</p>\n<p><img src=\"C:%5CUsers%5C96191%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20210513123355308.png\" alt=\"image-20210513123355308\" class=\"φcx\"></p>\n<p>进入setup文件</p>\n<blockquote>\n<p>cd hpcg/setup</p>\n</blockquote>\n<p>修改Make.Linux_MPI文件</p>\n<blockquote>\n<p>vim Make.LINUX_MPI</p>\n</blockquote>\n<p>找到<br>\nMPdir变量、MPlib、CXX变量<br>\n修改成：</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">MPdir        &#x3D; &#x2F;usr&#x2F;local</span><br><span class=\"line\">MPlib        &#x3D; $(MPdir)&#x2F;lib&#x2F;libmpi.a &#x2F;usr&#x2F;lib64&#x2F;libpthread-2.17.so &#x2F;usr&#x2F;lib64&#x2F;libc-2.17.so</span><br><span class=\"line\"></span><br><span class=\"line\">CXX          &#x3D; &#x2F;usr&#x2F;local&#x2F;bin&#x2F;mpicxx</span><br></pre></td></tr></table></figure>\n<ol>\n<li>\n<p>创建build文件夹：<code>mkdir build</code></p>\n</li>\n<li>\n<p>cd到build：<code>cd build</code></p>\n</li>\n<li>\n<p>设置安装环境：<code>/home/ssqiao/HPL/mpich-3.4.1/configure Linux_MPI</code></p>\n<p><img src=\"C:%5CUsers%5C96191%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20210513124901877.png\" alt=\"image-20210513124901877\" class=\"φcx\"></p>\n<p>（中间顺便换了一个Ubuntu软件配置源）</p>\n<p>.1LINUX命令需要大写</p>\n<p>.2mpicxx未安装</p>\n<p>运行以下命令安装</p>\n<blockquote>\n<p>sudo apt install libmpich-dev</p>\n</blockquote>\n</li>\n<li>\n<p>开始安装：<code>make</code></p>\n</li>\n<li>\n<p>运行测试：</p>\n<ol>\n<li>\n<p><code>cd bin</code></p>\n</li>\n<li>\n<p><code>mpirun -np 8 ./xhpcg</code></p>\n<p><img src=\"C:%5CUsers%5C96191%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20210513171430041.png\" alt=\"image-20210513171430041\" class=\"φcx\"></p>\n<p>尝试改小数字，然后能够正常运行</p>\n<p><code>mpirun -np 1 ./xhpcg</code></p>\n<p><code>mpirun -np 2 ./xhpcg</code></p>\n<p>生成一个txt文件</p>\n<p><img src=\"C:%5CUsers%5C96191%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20210513174521192.png\" alt=\"image-20210513174521192\" class=\"φcx\"></p>\n<p>6.查看测试结果</p>\n<p><img src=\"C:%5CUsers%5C96191%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20210513174539051.png\" alt=\"image-20210513174539051\" class=\"φcx\"></p>\n</li>\n</ol>\n</li>\n</ol>\n</blockquote>\n<h5 id=\"2.\">2.<a title=\"#2.\" href=\"#2.\"></a></h5>\n","next":{"title":"计通学院师资队伍整理","link":"2021/01/18/ustb_SCCE_Teachers"},"plink":"http://example.com/2021/05/01/HPLHPCG/","reward":true,"copyright":{"author":"SevenShao","link":"<a href=\"http://example.com/2021/05/01/HPLHPCG/\" title=\"HPLHPCG\">http://example.com/2021/05/01/HPLHPCG/</a>","license":"Attribution-NonCommercial-NoDerivatives 4.0 International (<a href=\"https://creativecommons.org/licenses/by-nc-sa/4.0/\" rel=\"external nofollow noopener\" target=\"_blank\">CC BY-NC-ND 4.0</a>)"}}